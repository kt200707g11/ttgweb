/*
 * Author: qtlenh@gmail.com
 * Date: 10/06/2016
 */
function ci(a){var b=document.createElement("img");return b.src=a,b}function measureText(a,b){var c=document.createElement("span");c.style.font=b,c.style.visibility="hidden",c.style.position="fixed",c.style.zIndex=-1,c.appendChild(document.createTextNode(a)),document.body.appendChild(c);var d=c.getBoundingClientRect().width;return document.body.removeChild(c),d}function createMarkerIcon(a,b,c){var d=document.createElement("canvas"),e=d.getContext("2d");return d.width=a.width,d.height=a.height,e.drawImage(a,0,0,a.width,a.height),e.font=c.font,e.fillStyle=c.color,e.fillText(b,c.left,c.top),d.toDataURL()}function decodeGeometry(a){a=JSON.parse(a);for(var b=a.length,c=[],d=0;d<b;d++)c.push(google.maps.geometry.encoding.decodePath(a[d]));return c}function Area(a,b){this.attrs=a,this.type=b}function Product(a){this.attrs={toilet_no:a[0],area:a[1],f:a[2],a:a[3],price:""+a[4],room_no:a[5],lat:a[6].lat,lng:a[6].lon,id:a[7]}}function initInfoBox(){ib=function(a){google.maps.OverlayView.call(this),"undefined"==typeof a&&(a={}),this.opts=a,this.opts.position||(this.opts.position="top"),this.opts.offsetLeft||(this.opts.offsetLeft=0),this.opts.panPadding||(this.opts.panPadding={top:0,right:0,bottom:0,left:0}),this.viewHolder=document.createElement("div"),this.viewHolder.style.position="absolute",this.viewHolder.className=this.opts.position,this.opts.content&&this.setContent(this.opts.content)},ib.prototype=new google.maps.OverlayView,ib.prototype.setPosition=function(a){this.opts.position=a,this.viewHolder.className=this.opts.position},ib.prototype.draw=function(){var a=this.getProjection().fromLatLngToDivPixel(this.position);this.viewHolder.style.left=a.x-this.viewHolder.offsetWidth/2+this.opts.offsetLeft+"px";var b=a.y-this.viewHolder.offsetHeight;"top"==this.opts.position?this.anchor instanceof google.maps.Marker&&(b-=this.anchor.getShape().coords[3]):b+=this.viewHolder.offsetHeight,this.viewHolder.style.top=b+"px",this.opts.disableAutoPan||this.boundsChangedListener&&this.panMap(),this.opts.onDraw&&this.opts.onDraw.apply(this)},ib.prototype.remove=function(){this.viewHolder.parentNode.removeChild(this.viewHolder)},ib.prototype.onAdd=function(){var a=this.getPanes();a.floatPane.appendChild(this.viewHolder);var b=this;this.opts.disableAutoPan||(this.boundsChangedListener=google.maps.event.addListener(this.map,"bounds_changed",function(){return b.panMap.apply(b)}))},ib.prototype.open=function(a,b){var c,d;a instanceof google.maps.Marker?(c=a.getPosition(),d=a.getMap()):a instanceof google.maps.Map&&(c=b?b:a.getCenter(),d=a),(this.anchor!==a||this.position.lat()!=c.lat()&&this.position.lng()!=c.lng())&&(this.anchor=a,this.position=c,this.setMap(d))},ib.prototype.close=function(){this.anchor=null,this.position=null,this.setMap(null)},ib.prototype.setContent=function(a){if(this.content=a,"string"==typeof a)this.viewHolder.innerHTML=a;else{for(;this.viewHolder.firstChild;)this.viewHolder.removeChild(this.viewHolder.firstChild);this.viewHolder.appendChild(a)}},ib.prototype.panMap=function(){var a=this.getMap(),b=a.getBounds();if(b){var c=b.getSouthWest().lng(),d=b.getNorthEast().lng(),e=b.getNorthEast().lat(),f=b.getSouthWest().lat(),g=this.getBounds(),h=g.getSouthWest().lng(),i=g.getNorthEast().lng(),j=g.getNorthEast().lat(),k=g.getSouthWest().lat(),l=(h<c?c-h:0)+(i>d?d-i:0),m=(j>e?e-j:0)+(k<f?f-k:0),n=a.getCenter(),o=n.lng()-l,p=n.lat()-m;a.panTo(new google.maps.LatLng(p,o)),google.maps.event.removeListener(this.boundsChangedListener),this.boundsChangedListener=null}},ib.prototype.getBounds=function(){var a=this.getMap();if(a){var b=a.getBounds();if(b){var c=a.getDiv(),d=c.offsetWidth,e=c.offsetHeight,f=b.toSpan(),g=f.lng(),h=f.lat(),i=g/d,j=h/e;if("top"==this.opts.position)var k=this.anchor instanceof google.maps.Marker?this.anchor.getShape().coords[3]:0;else var k=this.anchor instanceof google.maps.Marker?-this.viewHolder.offsetHeight:0;var l=this.position.lng()+(-(this.viewHolder.offsetWidth/2-this.opts.offsetLeft)-this.opts.panPadding.left)*i,m=this.position.lng()+(this.viewHolder.offsetWidth/2+this.opts.offsetLeft+this.opts.panPadding.right)*i,n=this.position.lat()-(-this.viewHolder.offsetHeight-k-this.opts.panPadding.top)*j,o=this.position.lat()-(this.opts.panPadding.bottom-k)*j;return new google.maps.LatLngBounds(new google.maps.LatLng(o,l),new google.maps.LatLng(n,m))}}}}var mi={PADDING:8,MIN_WIDTH:24,IMG:null,IMG_HOVER:null,COLOR:"black",COLOR_HOVER:"white",FONT:"12px Arial",ARROW_HEIGHT:0,TEXT_HEIGHT:0,MAX_WIDTH:0,MAX_HEIGHT:0,create:function(a,b){var c=b?mi.IMG_HOVER:mi.IMG,d=b?mi.COLOR_HOVER:mi.COLOR,e={color:d,font:mi.FONT},f=Math.round(measureText(a,e.font)),g=f+2*mi.PADDING;g<=mi.MIN_WIDTH?(g=mi.MIN_WIDTH,e.left=(g-f)/2):e.left=mi.PADDING;var h=Math.round(g*c.height/c.width),i=h*mi.ARROW_HEIGHT;return e.top=(h-i)/2+mi.TEXT_HEIGHT,c.width=g,c.height=h,mi.MAX_WIDTH<g&&(mi.MAX_WIDTH=g,mi.MAX_HEIGHT=h),{icon:createMarkerIcon(c,a,e),width:g,height:h}}};mi.IMG=ci("data:image/png;base64,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"),mi.IMG_HOVER=ci("data:image/png;base64,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"),mi.ARROW_HEIGHT=4/24,mi.TEXT_HEIGHT=4.5,Area.prototype.getPaths=function(){var b,a=this.attrs;return a.geometry&&0!==a.geometry.indexOf("[[[")&&(b=decodeGeometry(a.geometry)),b},Area.prototype.getBounds=function(){var b,a=this.getPaths();if(a){b=new google.maps.LatLngBounds;for(var c=a.length,d=0;d<c;d++)for(var e=a[d],f=e.length,g=0;g<f;g++)b.extend(e[g])}return b},Area.prototype.getCenter=function(){var b,a=this.attrs;if(a.center)centerP=JSON.parse(a.center),b=new google.maps.LatLng(centerP[0],centerP[1]);else{var c=this.getBounds();c&&(b=c.getCenter())}return b},Area.prototype.getName=function(){var a=this.attrs;return a.pre?a.pre+" "+a.name:a.name},Area.prototype.draw=function(a){var b=this.getPaths(),c=this;if("street"==this.type)b&&(this.poly=new google.maps.Polyline({map:a,path:b[0],strokeColor:m2Map.polygonColor,strokeOpacity:.8,strokeWeight:6,geodesic:!0}));else{b&&(this.poly=new google.maps.Polygon({map:a,paths:b,strokeColor:m2Map.polygonColor,strokeOpacity:.8,strokeWeight:1,fillColor:m2Map.polygonColor,fillOpacity:.2}),this.poly.addListener("mouseover",function(){c.marker&&c.marker.set("clickable",!1),c.mouseover()}),this.poly.addListener("mouseout",function(){c.marker&&c.marker.set("clickable",!0),c.mouseout()}),this.poly.addListener("click",function(){c.nextZoomLevel()}));var d=this.getCenter();d&&this.attrs.total>0&&(this.marker=new google.maps.Marker({map:a,position:d}),m2Map.setIcon(this.marker,this.attrs.total,0),this.marker.addListener("mouseover",function(){c.mouseover()}),this.marker.addListener("mouseout",function(){c.mouseout()}),this.marker.addListener("click",function(){c.nextZoomLevel()}))}},Area.prototype.remove=function(){this.poly&&this.poly.setMap(null),this.marker&&this.marker.setMap(null)},Area.prototype.mouseover=function(){m2Map.infoBoxHover.setContent('<div class="info-wrap-single"><div style="padding: 6px 12px; font-weight: bold; font-size: 13px; white-space: nowrap">'+this.getName()+'</div><div class="info-arrow"></div></div>'),this.marker?m2Map.infoBoxHover.open(this.marker):m2Map.infoBoxHover.open(m2Map.map,this.getCenter())},Area.prototype.mouseout=function(){m2Map.infoBoxHover.close()},Area.prototype.nextZoomLevel=function(){for(var a=m2Map.map.getZoom(),b=a+1,c=form.af.filter(s.iz).val(),d=form.getFocusLocation(),e=m2Map.getZoomAreaLevel(a,c,d.type),f=d.type;m2Map.getZoomAreaLevel(b,c,f)==e&&b<m2Map.detailZoomLevel;)b++;m2Map.map.setCenter(this.getCenter()),m2Map.map.setZoom(b)},Product.prototype.getMarkerKey=function(){return this.attrs.lat+"-"+this.attrs.lng},Product.prototype.getPosition=function(){return new google.maps.LatLng(this.attrs.lat,this.attrs.lng)},Product.prototype.getImage=function(){return this.attrs.f?this.attrs.f:"/themes/mv_desktop1/resources/images/default-ads.jpg"},Product.prototype.getPrice=function(){return formatPrice(this.attrs.price)+" "+lajax.t("VND")},Product.prototype.getAddress=function(){return this.attrs.a},Product.prototype.getAdditionInfo=function(){var a=[];return this.attrs.area&&a.push('<span class="icon-mv"><span class="icon-page-1-copy"></span></span>'+this.attrs.area+"m<sup>2</sup>"),this.attrs.room_no&&"0"!=this.attrs.room_no&&a.push('<span class="icon-mv"><span class="icon-bed-search"></span></span>'+this.attrs.room_no),this.attrs.toilet_no&&"0"!=this.attrs.toilet_no&&a.push('<span class="icon-mv"><span class="icon-icon-bathroom"></span></span>'+this.attrs.toilet_no),a.join('<i class="s"></i>')},Product.prototype.buildInfoContent=function(){var a=this.getImage(),b=this.getPrice(),c=this.getAddress(),d=this.getAdditionInfo();return'<div data-id="'+this.attrs.id+'" class="clearfix item"><div class="img-show left"><div><img src="'+a+'"></div></div><div class="right"><div class="rest-inside"><div class="address">'+c+'</div><div class="price">'+b+'</div><div class="addition">'+d+"</div></div></div></div>"},s.rect="#rect",s.ra="#ra",s.rm="#rm",s.rl="#rl",s.raK="#ra_k",s.iz="#iz",s.z="#z",s.c="#c",s.page="#page",s.did="#did";var contentHolder=$("#content-holder"),detailListingWrap=$(".detail-listing-dt"),m2Map={infoDetailWidth:174,infoDetailHeight:98,loadingTimeout:null,loadingList:$("#loading-list"),progressBar:$("#progress-bar"),mapEl:$("#map"),polygonColor:"#00a769",map:null,markers:{},areas:{},areasLevel:{city:3,district:2,ward:1},deteilZoomLevelDefault:16,detailZoomLevel:16,infoBoxHover:null,infoBoxDetailHover:null,infoBoxDetailClick:null,boundsChangedEvent:null,zoomChangedEvent:null,closeDetailListener:null,currentDrawState:null,markerIconCached:{},shape:{coords:[0,0,24,28],type:"rect"},wrapListing:$(".wrap-listing"),initMap:function(){History.Adapter.bind(window,"statechange",m2Map.stateChange),initInfoBox(),m2Map.infoBoxHover=new ib({disableAutoPan:!0,position:"top"}),m2Map.infoBoxDetailHover=new ib({disableAutoPan:!0}),m2Map.infoBoxDetailClick=new ib({disableAutoPan:!0,onDraw:m2Map.ibDrawed}),m2Map.infoBoxDetailClick.set("markers",[]);var a=form.afZoom.val(),b=form.afCenter.val();m2Map.mapOptions={center:{lat:10.783091,lng:106.704899},zoom:12,clickableIcons:!1,zoomControl:!1,streetViewControl:!1,mapTypeControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU}},a&&b?(m2Map.initMapRe(a,b),m2Map.hasMapInstance()):m2Map.initMapFresh(m2Map.hasMapInstance)},hasMapInstance:function(){var a=form.af.filter(s.did).val();a&&m2Map.detail(a)},stateChange:function(){},pushState:function(a){a||(a=form.serialize()),History.pushState({},document.title,form.mappingUrl(a))},initMapRe:function(a,b){m2Map.mapOptions.center=m2Map.urlValueToLatLng(b),m2Map.mapOptions.zoom=Number(a);m2Map.map=new google.maps.Map(m2Map.mapEl.get(0),m2Map.mapOptions);m2Map.initMapReFirstLoad(),google.maps.event.addListenerOnce(m2Map.map,"idle",m2Map.InitMapReIdle),m2Map.detectHasChange()},initMapReFirstLoad:function(){var a=form.getFocusLocation();if("project_building"==a.type)m2Map.currentDrawState="project_building",m2Map.changeLocation(m2Map.drawBuildingProject);else if("street"==a.type)m2Map.currentDrawState=a.type,form.af.filter(s.rl).val(""),form.af.filter(s.ra).val(a.type),form.af.filter(s.raK).val("id"),m2Map.ajaxRequest=m2Map.get(function(a){m2Map.drawStreet(a),a.ra&&a.ra.length&&m2Map.drawArea(new Area(a.ra[0],"street"))});else{var b=Number(form.af.filter(s.iz).val()),c=m2Map.mapOptions.zoom,d={ward:0,district:1,city:2};if(b+d[a.type]>=m2Map.deteilZoomLevelDefault?"city"==a.type?m2Map.detailZoomLevel=b+3:"district"==a.type?m2Map.detailZoomLevel=b+2:"ward"==a.type&&(m2Map.detailZoomLevel=b+1):m2Map.detailZoomLevel=m2Map.deteilZoomLevelDefault,c<m2Map.detailZoomLevel){var e=m2Map.getZoomAreaLevel(c,b,a.type);m2Map.currentDrawState=e,form.af.filter(s.ra).val(e);var f=a.type==e?"id":a.type+"_id";form.af.filter(s.raK).val(f);var g=form.fields.filter(s.rect).prop("disabled",!0);m2Map.ajaxRequest=m2Map.get(function(a){a.ra&&m2Map.drawAreas(a.ra,e)}),g.prop("disabled",!1)}else m2Map.currentDrawState="detail",m2Map.loadDetail("")}},InitMapReIdle:function(){form.afRect.val(m2Map.getBounds(28,12,0,12).toUrlValue()),m2Map.boundsChangedEvent=m2Map.map.addListener("bounds_changed",m2Map.boundsChanged),m2Map.zoomChangedEvent=m2Map.map.addListener("zoom_changed",m2Map.zoomChanged)},initMapFresh:function(a){m2Map.changeLocation(function(b){m2Map.drawMap(b),a()})},drawMap:function(a){m2Map.map=new google.maps.Map(m2Map.mapEl.get(0),m2Map.mapOptions);m2Map.drawLocation(a),m2Map.detectHasChange(),google.maps.event.addListenerOnce(m2Map.map,"bounds_changed",m2Map.setInitLocationProps)},detectHasChange:function(){var b,c,a=m2Map.map;google.maps.event.addListenerOnce(m2Map.map,"bounds_changed",function(){var d=a.getZoom();b=d,c=a.getCenter().toString()}),google.maps.event.addListenerOnce(m2Map.map,"idle",function(){var d=a.getZoom();if(d!=b||a.getCenter().toString()!=c){var e=form.getFocusLocation();"project_building"==e.type?"project_building"==m2Map.currentDrawState:"street"==e.type?"street"==m2Map.currentDrawState:d<m2Map.detailZoomLevel?(m2Map.zoomChanged(),m2Map.removeAllDetail()):(m2Map.currentDrawState="detail",m2Map.removeAreas(),m2Map.ajaxRequest&&(m2Map.ajaxRequest.abort(),m2Map.ajaxRequest=null),m2Map.infoBoxHover.close(),form.af.filter(s.page).val(""),form.af.filter(s.ra).val(""),form.af.filter(s.rm).val(1),form.af.filter(s.rl).val(1),m2Map.ajaxRequest=m2Map.get(function(a){m2Map.removeAreas(),m2Map.drawDetailCallBack(a)})),form.afRect.val(m2Map.getBounds(28,12,0,12).toUrlValue()),form.afZoom.val(m2Map.map.getZoom()),form.afCenter.val(m2Map.getCenter().toUrlValue()),m2Map.pushState()}})},setInitLocationProps:function(){var a=m2Map.map.getZoom(),b=form.getFocusLocation();m2Map.currentDrawState=b.type,form.af.filter(s.iz).val(a);var c={ward:0,district:1,city:2};a+c[b.type]>=m2Map.deteilZoomLevelDefault?"city"==b.type?m2Map.detailZoomLevel=a+3:"district"==b.type?m2Map.detailZoomLevel=a+2:"ward"==b.type&&(m2Map.detailZoomLevel=a+1):m2Map.detailZoomLevel=m2Map.deteilZoomLevelDefault},boundsChanged:function(){var a=m2Map.map;clearTimeout(a.get("bounds_changed_timeout")),a.set("bounds_changed_timeout",setTimeout(function(){form.afRect.val(m2Map.getBounds(28,12,0,12).toUrlValue()),form.afZoom.val(m2Map.map.getZoom()),form.afCenter.val(m2Map.getCenter().toUrlValue()),"detail"==m2Map.currentDrawState?m2Map.loadDetail(1):"street"==m2Map.currentDrawState&&m2Map.loadDetail(1),m2Map.pushState()},100))},zoomChanged:function(){var a=m2Map.map.getZoom();if("project_building"==m2Map.currentDrawState||"street"==m2Map.currentDrawState)return!1;if(a<m2Map.detailZoomLevel){form.af.filter(s.rl).val(""),"detail"==m2Map.currentDrawState&&(m2Map.infoBoxDetailHover.close(),m2Map.removeAllDetail(),form.af.filter(s.rm).val(""),form.af.filter(s.page).val(""),form.af.filter(s.rl).val(1));var b=form.getFocusLocation(),c=m2Map.getZoomAreaLevel(m2Map.map.getZoom(),form.af.filter(s.iz).val(),b.type);if(m2Map.currentDrawState!=c){m2Map.infoBoxHover.close(),m2Map.ajaxRequest&&(m2Map.ajaxRequest.abort(),m2Map.ajaxRequest=null),m2Map.infoBoxHover.close(),m2Map.currentDrawState=c,form.af.filter(s.ra).val(c);var d=b.type==c?"id":b.type+"_id";form.af.filter(s.raK).val(d);var e=form.fields.filter(s.rect).prop("disabled",!0);m2Map.ajaxRequest=m2Map.get(function(a){a.ra&&m2Map.drawAreas(a.ra,c),a.rl&&m2Map.drawList(a.rl)}),e.prop("disabled",!1)}}else m2Map.infoBoxHover.close(),m2Map.currentDrawState="detail",m2Map.removeAreas()},loadDetail:function(a){m2Map.ajaxRequest&&(m2Map.ajaxRequest.abort(),m2Map.ajaxRequest=null),m2Map.infoBoxHover.close(),form.af.filter(s.page).val(""),form.af.filter(s.ra).val(""),form.af.filter(s.rm).val(1),form.af.filter(s.rl).val(a),m2Map.ajaxRequest=m2Map.get(m2Map.drawDetailCallBack)},drawLocation:function(a){var b=form.getFocusLocation();if(a.rm&&("street"==b.type?m2Map.drawStreet(a):m2Map.drawBuildingProject(a,!0)),a.ra&&a.ra.length){var c=new Area(a.ra[0],b.type);if(m2Map.drawAndFitArea(c),"street"==b.type){var d=c.getBounds(),e=c.getCenter();d||e||a.rm&&a.rm.length&&m2Map.setCenter({lat:Number(a.rm[0].lat),lng:Number(a.rm[0].lng)})}}google.maps.event.addListenerOnce(m2Map.map,"idle",m2Map.drawLocationCallback)},drawBuildingProject:function(a,b){m2Map.removeAllDetail(),m2Map.removeAreas();var c=$(".infor-duan-suggest");if(c.length&&c.data("lat")&&c.data("lng"))var d={lat:c.data("lat"),lng:c.data("lng")};else if(a.rm.length)var d={lat:Number(a.rm[0].lat),lng:Number(a.rm[0].lng)};if(d){b===!0&&(m2Map.setCenter(d),m2Map.map.setZoom(m2Map.deteilZoomLevelDefault));var e=new google.maps.Marker({map:m2Map.map,position:d}),f=[];for(var g in a.rm)f.push(new Product(a.rm[g]));e.addListener("click",m2Map.markerClick),e.addListener("mouseover",m2Map.markerMouseOver),e.addListener("mouseout",m2Map.markerMouseOut),e.set("products",f),m2Map.setIcon(e,f.length,0),m2Map.markers[d]=e}},drawLocationCallback:function(){null==m2Map.boundsChangedEvent&&(m2Map.boundsChangedEvent=m2Map.map.addListener("bounds_changed",m2Map.boundsChanged)),null==m2Map.zoomChangedEvent&&(m2Map.zoomChangedEvent=m2Map.map.addListener("zoom_changed",m2Map.zoomChanged))},drawAndFitArea:function(a){var b=a.getBounds();if(b)m2Map.fitBounds(a.getBounds());else{var c=a.getCenter();c&&m2Map.setCenter(c)}m2Map.drawArea(a)},changeLocation:function(a){var b=form.getFocusLocation();"project_building"==b.type?form.af.filter(s.rm).val(1):(form.af.filter(s.ra).val(b.type),form.af.filter(s.raK).val("id"),"street"==b.type&&form.af.filter(s.rm).val(1));var c=form.fields.filter(s.rect);"project_building"==b.type&&c.prop("disabled",!0),m2Map.get(a),"project_building"==b.type&&c.prop("disabled",!1)},drawStreet:function(a){a.rm&&(m2Map.removeAllDetail(),m2Map.drawDetail(a.rm))},removeAreas:function(){var a=m2Map.areas;a.length;for(var c in a)a[c].remove();m2Map.areas={}},drawAreas:function(a,b){m2Map.removeAreas();for(var c=a.length,d=0;d<c;d++){var e=new Area(a[d],b);m2Map.drawArea(e)}},drawArea:function(a){a.draw(m2Map.map),m2Map.areas[a.attrs.id]=a},drawDetailCallBack:function(a){a.rm&&(m2Map.removeAllDetail(),m2Map.drawDetail(a.rm)),a.rl&&m2Map.drawList(a.rl)},drawDetail:function(a){for(var b=m2Map.map,c=m2Map.markers,d=a.length,e=0;e<d;e++){var f=new Product(a[e]),g=f.getMarkerKey(),h=c[g];if(h){var i=h.get("products");i.push(f),h.set("products",i),m2Map.setIcon(h,i.length,0)}else h=new google.maps.Marker({map:b,position:f.getPosition()}),h.addListener("click",m2Map.markerClick),h.addListener("mouseover",m2Map.markerMouseOver),h.addListener("mouseout",m2Map.markerMouseOut),h.set("products",[f]),m2Map.setIcon(h,1,0),c[g]=h}},markerMouseOver:function(){var a=this.get("products");if(m2Map.setIcon(this,a.length,1),this.setZIndex(google.maps.Marker.MAX_ZINDEX++),!m2Map.isAttachingClickInfo(this)){var b=a[0],c=m2Map.getMarkerPadding(this);if(c.left<m2Map.infoDetailWidth)var d=c.left<m2Map.infoDetailWidth?m2Map.infoDetailWidth-c.left+6:0;else var d=c.right<m2Map.infoDetailWidth?c.right-m2Map.infoDetailWidth-6:0;c.top-this.getShape().coords[3]<m2Map.infoDetailHeight+11?m2Map.infoBoxDetailHover.setPosition("bottom"):m2Map.infoBoxDetailHover.setPosition("top"),m2Map.infoBoxDetailHover.opts.offsetLeft=d;var e='<div class="info-wrap-detail info-wrap-single">'+b.buildInfoContent()+'<div class="info-arrow" style="margin-left: '+-Math.round(d+5)+'px"></div></div>';m2Map.infoBoxDetailHover.setContent(e),m2Map.infoBoxDetailHover.open(this)}},isAttachingClickInfo:function(a){return!!m2Map.infoBoxDetailClick.anchor&&m2Map.infoBoxDetailClick.anchor.getPosition().equals(a.getPosition())},markerMouseOut:function(){m2Map.infoBoxDetailHover.close();var a=this.get("products");m2Map.setIcon(this,a.length,0)},markerClick:function(){var a=this.get("products");if(1==a.length){var b=a[0];m2Map.showDetail(b.attrs.id)}else if(!m2Map.isAttachingClickInfo(this)){m2Map.infoBoxDetailHover.close();var c=m2Map.getMarkerPadding(this),d=c.top>c.bottom?"top":"bottom",e=Math.round(c[d])-12;if("top"==d&&(e-=this.getShape().coords[3]),a.length*m2Map.infoDetailHeight<e&&(e=a.length*m2Map.infoDetailHeight),c.left<m2Map.infoDetailWidth)var f=c.left<m2Map.infoDetailWidth?m2Map.infoDetailWidth-c.left+6:0;else var f=c.right<m2Map.infoDetailWidth?c.right-m2Map.infoDetailWidth-6:0;var g='<div class="info-wrap-detail info-wrap-single"><div class="scroll" style="height: '+e+'px; overflow: hidden;">';for(var h in a)g+=a[h].buildInfoContent();g+='</div><div class="info-arrow" style="margin-left: '+-Math.round(f+5)+'px"></div></div>',m2Map.infoBoxDetailClick.opts.offsetLeft=f,m2Map.infoBoxDetailClick.setContent(g),m2Map.infoBoxDetailClick.setPosition(d),m2Map.infoBoxDetailClick.open(this)}},ibDrawed:function(){function h(){a.close(),m2Map.map.set("scrollwheel",!0),google.maps.event.removeListener(f),google.maps.event.removeListener(g)}var a=this,b=$(this.viewHolder),c=b.find(".scroll"),d=b.find(".info-wrap-detail");b.find(".close-detail");c.slimScroll({height:c.height()+"px",allowPageScroll:!1,borderRadius:0}),d.mouseenter(function(){m2Map.map.set("scrollwheel",!1);for(var b=a.get("markers"),c=b.length,d=0;d<c;d++)b[d].set("clickable",!1)}),d.mouseleave(function(b){m2Map.map.set("scrollwheel",!0);for(var c=a.get("markers"),d=c.length,e=0;e<d;e++)c[e].set("clickable",!0)}),c.find(".item").click(function(a){m2Map.showDetail($(this).data("id")),a.stopPropagation()});var f=google.maps.event.addListenerOnce(m2Map.map,"bounds_changed",function(){h()}),g=google.maps.event.addListenerOnce(m2Map.map,"click",function(){h()}),i=a.getBounds(),j=m2Map.map.getBounds(),k=i.getSouthWest(),l=i.getNorthEast(),m=m2Map.getScaleOffset(j),n=k.lat()+-mi.MAX_HEIGHT*m.y,o=k.lng()+-(mi.MAX_WIDTH/2)*m.x,p=l.lat(),q=l.lng()+mi.MAX_WIDTH/2*m.x,r=new google.maps.LatLngBounds(new google.maps.LatLng(n,o),new google.maps.LatLng(p,q)),s=[];for(var t in m2Map.markers){var u=m2Map.markers[t];r.contains(u.getPosition())&&s.push(u)}a.set("markers",s)},removeAllDetail:function(){var a=m2Map.markers;for(var b in a)a[b].setMap(null);m2Map.markers={}},drawList:function(a){contentHolder.html(a)},getBounds:function(a,b,c,d){var e=m2Map.map.getBounds(),f=e.getSouthWest(),g=e.getNorthEast(),h=m2Map.getScaleOffset(e),i=f.lat()+c*h.y,j=f.lng()+d*h.x,k=g.lat()-a*h.y,l=g.lng()-b*h.x;return new google.maps.LatLngBounds(new google.maps.LatLng(i,j),new google.maps.LatLng(k,l))},getScaleOffset:function(a){var b=m2Map.map.getDiv(),c=b.offsetWidth,d=b.offsetHeight,e=a.toSpan(),f=e.lat(),g=e.lng(),h=g/c,i=f/d;return{x:h,y:i}},getMarkerPadding:function(a){var b=m2Map.map.getBounds(),c=m2Map.getScaleOffset(b),d={top:(b.getNorthEast().lat()-a.getPosition().lat())/c.y,bottom:(a.getPosition().lat()-b.getSouthWest().lat())/c.y,left:(a.getPosition().lng()-b.getSouthWest().lng())/c.x,right:(b.getNorthEast().lng()-a.getPosition().lng())/c.x};return d},getCenter:function(){return m2Map.map.getCenter()},setCenter:function(a){m2Map.map.setCenter(a)},fitBounds:function(a){m2Map.map.fitBounds(a)},setIcon:function(a,b,c){if(1==b){var d="/images/marker-"+c+".png";a.setShape(m2Map.shape)}else{var e=b+"-"+c,f=m2Map.markerIconCached[e];if(f)var g=f;else{var g=mi.create(b,c);m2Map.markerIconCached[e]=g}var d=g.icon,h={coords:[0,0,g.width,g.height],type:"rect"};a.setShape(h)}a.setIcon(d)},get:function(a,b){b||(b=form.serialize());var c=form.af.filter(s.rl).val(),d=form.af.filter(s.rm),e=form.af.filter(s.ra).val()||d.val()&&!d.prop("disabled");return e&&m2Map.loading(10),c&&m2Map.loadingList.show(),$.ajax({url:"/map/get",data:b,success:a,complete:function(){c&&(m2Map.loadingList.hide(),m2Map.wrapListing.scrollTop(0)),e&&m2Map.loaded()}})},urlValueToLatLng:function(a){var b=a.split(",");return new google.maps.LatLng(b[0],b[1])},getZoomAreaLevel:function(a,b,c){b=Number(b);var d=m2Map.areasLevel[c],e=m2Map.detailZoomLevel-b,f=m2Map.detailZoomLevel-a;if(f>e)return c;var g=Math.ceil(e/d),h=Math.ceil((e-g)/(d-1))+g;return f<=g?"ward":f<=h?"district":"city"},getFocusMarker:function(a){var b=m2Map.markers;for(var c in b)for(var d=b[c],e=d.get("products"),f=e.length,g=0;g<f;g++)if(e[g].attrs.id==a)return d},focusMarker:function(a){m2Map.setIcon(a,a.get("products").length,1),a.setZIndex(google.maps.Marker.MAX_ZINDEX++)},showDetail:function(a){m2Map.detail(a),form.af.filter(s.did).val(a),m2Map.pushState()},detail:function(a){var c=($(".wrap-listing-item .inner-wrap").outerWidth(),$(".detail-listing"));detailListingWrap.loading({full:!1}).addClass("show-detail"),google.maps.event.removeListener(m2Map.closeDetailListener),m2Map.closeDetailListener=m2Map.map.addListener("click",m2Map.closeDetail),$.get("/listing/detail",{id:a},function(a){var b=$(a).find("#detail-wrap");b.find(".popup-common").each(function(){var a=$(this),b=a.attr("id");$("body").find("#"+b).remove()}),c.find(".container").html($(a).find("#detail-wrap").html()),c.find(".popup-common").appendTo("body");new Swiper(".swiper-container",{pagination:".swiper-pagination",paginationClickable:!0,spaceBetween:0});detailListingWrap.loading({done:!0}),$(".inner-detail-listing").scrollTop(0),$(".btn-extra").attr("href",c.find(".btn-copy").data("clipboard-text"))})},closeDetail:function(a){a.preventDefault&&a.preventDefault();$(".wrap-listing-item .inner-wrap").outerWidth();detailListingWrap.removeClass("show-detail"),form.af.filter(s.did).val(""),m2Map.pushState()},loading:function(a){m2Map.progressBar.show(),m2Map.loading_(a)},loading_:function(a){m2Map.progressBar.width(a+"%"),a<90&&(m2Map.loadingTimeout=setTimeout(function(){m2Map.loading_(a+10)},10*a))},loaded:function(){clearTimeout(m2Map.loadingTimeout),m2Map.progressBar.width("100%"),m2Map.loadingTimeout=setTimeout(function(){m2Map.progressBar.hide().width("0%")},150)},addDrawControl:function(){var a=document.createElement("div");a.className="draw-wrap",a.index=1;var b=document.createElement("a");b.className="button draw-button",b.innerHTML='<span class="icon-mv"><span class="icon-edit-copy-4"></span></span>Vẽ khoanh vùng';var c=document.createElement("a");c.className="button remove-button",c.innerHTML='<span class="icon-mv"><span class="icon-close-icon"></span></span>Xóa khoanh vùng',a.appendChild(b),a.appendChild(c),m2Map.map.controls[google.maps.ControlPosition.TOP_LEFT].push(a)}};form.af=$("#af-wrap").children(),form.afRect=form.af.filter(s.rect),form.afZoom=form.af.filter(s.z),form.afCenter=form.af.filter(s.c),form.projectInfoEl=$("#project-info");var ttobj={timeout:null,lastestUrl:"",tracking:function(){clearTimeout(this.timeout),""==ttobj.lastestUrl&&(ttobj.lastestUrl=window.location.href+"");var a=form.fields.filter(function(){return!!this.value}).serialize(),b={location:form.mapSearchEl.val(),payload:a,tf:tf_ip};this.timeout=setTimeout(function(){b.referer=ttobj.lastestUrl,tracking(b),ttobj.lastestUrl=""},detr)}};form.formChange=function(a){ttobj.tracking();var b=$(a.target);if(form.af.filter(s.rl).val(1),b.hasClass("search-item")){if(form.af.val(""),form.af.filter(s.rl).val(1),google.maps.event.removeListener(m2Map.boundsChangedEvent),m2Map.boundsChangedEvent=null,google.maps.event.removeListener(m2Map.zoomChangedEvent),m2Map.zoomChangedEvent=null,google.maps.event.addListenerOnce(m2Map.map,"bounds_changed",m2Map.setInitLocationProps),m2Map.removeAllDetail(),"project_building"==b.data("type")){form.projectInfoEl.html("");var c=b.data("id");$.get(loadProjectUrl,{id:c},function(a){form.projectInfoEl.html(a),toogleScroll()})}else form.projectInfoEl.html(""),toogleScroll();m2Map.changeLocation(function(a){m2Map.removeAreas(),m2Map.drawLocation(a),a.rl&&m2Map.drawList(a.rl)})}else if("order_by"==b.attr("id")){form.af.filter(s.ra).val(""),form.af.filter(s.raK).val(""),form.af.filter(s.page).val(""),m2Map.pushState();var d=form.fields.filter(s.rect);"city"==m2Map.currentDrawState||"district"==m2Map.currentDrawState||"ward"==m2Map.currentDrawState||"project_building"==m2Map.currentDrawState?(d.prop("disabled",!0), form.af.filter(s.rm).prop("disabled",!0)):form.af.filter(s.rm).val(1),form.af.filter(s.rl).val(1),m2Map.get(m2Map.drawDetailCallBack),d.prop("disabled",!1),form.af.filter(s.rm).prop("disabled",!1)}else{form.af.filter(s.rl).val(1),form.af.filter(s.page).val("");var d=form.fields.filter(s.rect);if("city"==m2Map.currentDrawState||"district"==m2Map.currentDrawState||"ward"==m2Map.currentDrawState){d.prop("disabled",!0),form.af.filter(s.rm).val("");var e=form.getFocusLocation(),f=m2Map.getZoomAreaLevel(m2Map.map.getZoom(),form.af.filter(s.iz).val(),e.type);form.af.filter(s.ra).val(f);var g=e.type==f?"id":e.type+"_id";form.af.filter(s.raK).val(g)}else form.af.filter(s.rm).val(1),form.af.filter(s.ra).val("");m2Map.get(function(a){m2Map.drawList(a.rl),a.rm&&(m2Map.removeAllDetail(),"project_building"==m2Map.currentDrawState?m2Map.drawBuildingProject(a):m2Map.drawDetail(a.rm)),a.ra&&m2Map.drawAreas(a.ra,f)}),d.prop("disabled",!1)}m2Map.pushState()},form.serialize=function(){return form.serialize_(form.fields)},form.serialize_=function(a){return a.filter(function(){return!!this.value}).serialize()},form.toggleConditionFields=function(){desktop.isDesktop()?form.af.prop("disabled",!1):form.af.prop("disabled",!0)},form.getFocusLocation=function(){var a={};return form.autoFill.each(function(){var b=$(this),c=b.val();c&&(a.id=c,a.type=b.attr("id").replace("_id",""))}),a},form.pagination=function(a){a.preventDefault(),form.af.filter(s.ra).val(""),form.af.filter(s.raK).val("");var b=Number($(this).data("page"))+1,c=form.af.filter(s.page);1==b?c.val(""):c.val(b),m2Map.pushState();var d=form.fields.filter(s.rect);"city"!=m2Map.currentDrawState&&"district"!=m2Map.currentDrawState&&"ward"!=m2Map.currentDrawState||d.prop("disabled",!0),form.af.filter(s.rl).val(1),form.af.filter(s.rm).prop("disabled",!0),m2Map.get(form.paginationCallback),form.af.filter(s.rl).val(""),form.af.filter(s.rm).prop("disabled",!1),d.prop("disabled",!1)},form.paginationCallback=function(a){m2Map.drawList(a.rl)},form.itemClick=function(a){a.preventDefault();var b=$(this).data("id");m2Map.showDetail(b)},form.itemMouseEnter=function(a){var b=$(this).data("id");$.data(this,"mouseenterTimer",setTimeout(function(){var a=m2Map.getFocusMarker(b);a&&m2Map.focusMarker(a)},300))},form.itemMouseLeave=function(a){clearTimeout($.data(this,"mouseenterTimer"));var b=m2Map.getFocusMarker($(this).data("id"));b&&m2Map.setIcon(b,b.get("products").length,0)},events.attachDesktopEvent(form.fields,"change",form.formChange),events.attachDesktopEvent(form.listSearchEl,"click","a",form.formChange),events.attachDesktopEvent(contentHolder,"click",".pagination a",form.pagination),events.attachDesktopEvent(contentHolder,"click",".item a",form.itemClick),events.attachDesktopEvent($(".close-slide-detail"),"click",m2Map.closeDetail),events.attachDesktopEvent(contentHolder,"mouseenter",".item a",form.itemMouseEnter),events.attachDesktopEvent(contentHolder,"mouseleave",".item a",form.itemMouseLeave),events.attachDesktopEvent($window,"resize",form.toggleConditionFields);var ib;form.toggleConditionFields(),desktop.loadedResource();